# Application CDR to UDR
Микросервис для генерации CDR-записей, их сохранения в базу данных и предоставления REST API для получения UDR-отчетов.
## Подробное описание
Микросервис эмулирует работу коммутатора, генерирует CDR записи, сохраняет их в базу данных и предоставляет REST-API для получения UDR отчетов и генерации сводного отчета с CDR записями по абоненту в csv формате.
### CDR - запись включает в себя:
* тип вызова (01 - исходящие, 02 - входящие);
* номер абонента, инициирующего звонок;
*  номер абонента, принимающего звонок;
* дата и время начала звонка (ISO 8601);
*  дата и время окончания звонка (ISO 8601);
### CDR - отчет представляет из себя набор CDR-записей
* разделитель данных – запятая;
* разделитель записей – перенос строки;
* данные обязательно формируются в хронологическом порядке;
* формат csv;

# Запуск приложения
## Через JAR-файл:
1. Установите JAR-файл в разделе [Releases](https://github.com/SnowyPython/ApplicationCDRtoUDR/releases/tag/v1.0.0)
2. Убедитесь, что у вас установлена Java версии 17 и выше
    ```bash
    java -version
    ```
3. Выполните команду
    ```bash
   java -jar ApplicationCDRtoUDR-0.0.1-SNAPSHOT.jar
    ```
## Через исходный код:
1. Клонируйте репозиторий
2. Выполните команды
    ```bash
    mvn clean install
    mvn spring-boot:run
    ```
   
# REST API эндпоинты
### Генерация CDR отчета:
* Эндпоинт: `GET /cdr/generate/{msisdn}`
* Описание: запускает генерацию CDR отчета в формате .csv, который сохраняется в src/main/resources/reports
* **Параметры:**
    * `msisdn` номер абонента
    * `startDate` начальная граница периода, для которого необходим отчет
    * `endDate` конечная граница периода, для которого необходим отчет
### Получение UDR отчета для всех абонентов:
* **Эндпоинты:** `GET /udr/report/all`
* **Описание:** возвращает UDR отчет для всех абонентов в формате JSON
* **Параметры:**
    * `numberOfMonth` номер месяца, за который необходимо получить отчет
### Получение UDR отчета для конкретного пользователя за определенный период:
* **Эндпоинты:** `GET /udr/report/{msisdn}`
* **Описание:** возвращает UDR отчет для всех абонентов в формате JSON
* **Параметры:**
  * `msisdn` номер абонента
  * `period` период "Y" - год или "M" - месяц
  * `numberOfMonth` номер месяца (опционально)
# База данных
**Для взаимодействия с бд необходимо открыть:** http://localhost:8080/h2-console
* **URL БД:** `jdbc:h2:file:~/db/application`
* **username:** `sa`
* **password:** `sa`

